---
import highlightCache from "./CodeHighlight/cache"
import astroHighlightCode from "./CodeHighlight/astroHighlightCode"

const { code, lang = 'plaintext', theme = 'github-dark', wrap = false, id = "" } = Astro.props;

let html
if(id && highlightCache.has(id)){
    html = highlightCache.get(id)
} else {
    html = await astroHighlightCode({ code, lang, theme, wrap })

    if(id){
        highlightCache.set(id, html)
    }
}
---

<Fragment set:html={html} />